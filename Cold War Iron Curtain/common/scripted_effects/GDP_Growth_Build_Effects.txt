#GDP Growth Planning
#industrial_complex_tech_calc
#farm_tech_calc
#oil_refinery_tech_calc
#steel_works_tech_calc
#tungsten_factory_tech_calc
#office_park_tech_calc

#Global GDP Growth Formula
#+ Ease of Business Modifier 
#    + Womens Rights Semi-Traditionalism = no effect, regressive levels negative, equality+ beneficial
#    + Labour Neutral = no effect, less worker rights = higher growth etc
#    + Minority Rights = Equal Rights = no change, same for positive action, lower levels cause penalty
#
#    + CPI = Local and Metro = Penalty due to lack of protection, federal+militarized = small bump, higher levels = smaller penalty
#    + Healthcare = Formal = no penalty, higher is better, below formal = penalty
#    + Public Services: Basic = no penalty, higher good, minimal = penalty
#    + Public Education Nominal = no penalty, higher good, lower bad adjusts annual literacy rate
#+ Country Specific Modifier (Placeholder for Future)
#+ Random variable, if under 0.5 multiply by -1 and subtract from total, add if 0.5+
#- Tax Rate
#- Corruption Modifier
#= Base Growth Percentage
#x Current GDP
GDP_Growt_Capitalist_Calc = {
    set_variable = {
        yearly_gdp_growth = VTC.global_gdp_rate
    }
    set_variable = {
        EoBM_Percentage = 0
    }
    #Womens Rights Adjustment
    if = {
        limit = {
            has_idea = policy_women_temp_0
        }
        add_to_variable = {
            EoBM_Percentage = -0.02
        }
    }
    if = {
        limit = {
            has_idea = policy_women_temp_1
        }
        add_to_variable = {
            EoBM_Percentage = -0.01
        }
    }
    if = {
        limit = {
            has_idea = policy_women_temp_2
        }
        add_to_variable = {
            EoBM_Percentage = 0.01
        }
    }
    if = {
        limit = {
            has_idea = policy_women_temp_3
        }
        add_to_variable = {
            EoBM_Percentage = 0.02
        }
    }
    if = {
        limit = {
            OR = {
                has_idea = policy_women_temp_4
                has_idea = policy_women_temp_4a
            }
        }
        add_to_variable = {
            EoBM_Percentage = 0.03
        }
    }
    #Labor Adjustment
    if = {
        limit = {
            has_idea = policy_union_temp_0
        }
        add_to_variable = {
            EoBM_Percentage = 0.05
        }
    }
    if = {
        limit = {
            has_idea = policy_union_temp_1
        }
        add_to_variable = {
            EoBM_Percentage = 0.03
        }
    }
    if = {
        limit = {
            has_idea = policy_union_temp_2
        }
        add_to_variable = {
            EoBM_Percentage = 0.01
        }
    }
    if = {
        limit = {
            has_idea = policy_union_temp_3
        }
        add_to_variable = {
            EoBM_Percentage = -0.01
        }
    }
    if = {
        limit = {
            has_idea = policy_union_temp_4
        }
        add_to_variable = {
            EoBM_Percentage = -0.03
        }
    }
    if = {
        limit = {
            has_idea = policy_union_temp_5
        }
        add_to_variable = {
            EoBM_Percentage = -0.05
        }
    }
    #Civil Rights Penalty
    if = {
        limit = {
            has_idea = policy_minorities_temp_0
        }
        add_to_variable = {
            EoBM_Percentage = -0.05
        }
    }
    if = {
        limit = {
            has_idea = policy_minorities_temp_1
        }
        add_to_variable = {
            EoBM_Percentage = -0.03
        }
    }
    if = {
        limit = {
            has_idea = policy_minorities_temp_2
        }
        add_to_variable = {
            EoBM_Percentage = -0.01
        }
    }
    ##CPI## 

    ##Healthcare## 

    ##Public## 

    ##Public Education## 

    ##EoBM Calc##
    add_to_variable = { yearly_gdp_growth = EoBM_Percentage }

    ##Nation Specific Modifier##
    add_to_variable = { yearly_gdp_growth = custom_gdp_modifier }

    ##Tax Rate##
    if = {
        limit = {
            has_idea = policy_taxrate_temp_1
        }
        add_to_variable = {
            yearly_gdp_growth = 0.10
        }
    }
    if = {
        limit = {
            has_idea = policy_taxrate_temp_2
        }
        add_to_variable = {
            yearly_gdp_growth = 0.05
        }
    }
    if = {
        limit = {
            has_idea = policy_taxrate_temp_3
        }
        add_to_variable = {
            yearly_gdp_growth = 0.01
        }
    }
    if = {
        limit = {
            has_idea = policy_taxrate_temp_4
        }
        add_to_variable = {
            yearly_gdp_growth = -0.05
        }
    }
    if = {
        limit = {
            has_idea = policy_taxrate_temp_5
        }
        add_to_variable = {
            yearly_gdp_growth = -0.10
        }
    }

    ##Corruption##
    subtract_from_variable = { yearly_gdp_growth = CorruptionLevel }

    ##Overall Calc##
    set_variable = { yearly_gdp_growth_prior_display = yearly_gdp_growth }
    multiply_variable = { yearly_gdp_growth = grossdomesticproduct }

    ##Weighting for Building Sorting##
    #1 2 3 4 5
    #Corresponds to Dev Levels in States
    if = {
        limit = {
            check_variable = {
                national_development_level = 1
            }        
        }
        set_variable = { office_park_ratio = 0 }
        set_variable = { industrial_complex_ratio = 0 }
        set_variable = { farm_ratio = 1 }
    }
    else_if = {
        limit = {
            check_variable = {
                national_development_level = 2
            }        
        }
        set_variable = { office_park_ratio = 0 }
        set_variable = { industrial_complex_ratio = 0.33 }
        set_variable = { farm_ratio = 0.67 }
    }
    else_if = {
        limit = {
            check_variable = {
                national_development_level = 3
            }        
        }
        set_variable = { office_park_ratio = 0.10 }
        set_variable = { industrial_complex_ratio = 0.50 }
        set_variable = { farm_ratio = 0.40 }
    }
    else_if = {
        limit = {
            check_variable = {
                national_development_level = 4
            }        
        }
        set_variable = { office_park_ratio = 0.25 }
        set_variable = { industrial_complex_ratio = 0.55 }
        set_variable = { farm_ratio = 0.20 }
    }
    else_if = {
        limit = {
            check_variable = {
                national_development_level = 5
            }        
        }
        set_variable = { office_park_ratio = 0.45 }
        set_variable = { industrial_complex_ratio = 0.35 }
        set_variable = { farm_ratio = 0.20 }
    }
    else = {
        set_variable = { office_park_ratio = 0.0 }
        set_variable = { industrial_complex_ratio = 0.5 }
        set_variable = { farm_ratio = 0.5 }        
    }
    if = {
        limit = {
            has_country_flag = agricultural_emphasis
            NOT = {
                check_variable = {
                    national_development_level = 0
                }               
            }
        }
        add_to_variable = { farm_ratio = 0.20 }
        subtract_from_variable = { industrial_complex_ratio = -0.20 }
    }
    if = {
        limit = {
            has_country_flag = industrial_emphasis
            NOT = {
                check_variable = {
                    national_development_level = 0
                }               
            }
        }
        add_to_variable = { farm_ratio = -0.20 }
        subtract_from_variable = { industrial_complex_ratio = 0.20 }
    }
    if = {
        limit = {
            has_country_flag = services_emphasis
            NOT = {
                check_variable = {
                    national_development_level = 0
                }               
            }
        }
        add_to_variable = { industrial_complex_ratio = -0.20 }
        subtract_from_variable = { office_park_ratio = 0.20 }
    }
    multiply_variable = {
        farm_ratio = yearly_gdp_growth
    }
    multiply_variable = {
        industrial_complex_ratio = yearly_gdp_growth
    }
    multiply_variable = {
        office_park_ratio = yearly_gdp_growth
    }
    clear_array = gdp_build_state_array
    every_owned_state = {
        limit = {
            NOT = { has_state_category = wasteland }
        }
        add_to_array = {
            array = PREV.gdp_build_state_array
            value = THIS.id
        }
    }
    #Building Pools
    divide_variable = { industrial_complex_ratio = industrial_complex_tech_calc }
    divide_variable = { office_park_ratio = office_park_tech_calc }
    divide_variable = { farm_ratio = farm_tech_calc }

    #industrial_complex_tech_calc
    #office_park_tech_calc
    #farm_tech_calc
}